define(["jquery","jqueryui","mod_icontent/cookiehandler"],function(t,a,e){function n(){var a={action:"loadpage",id:t(this).attr("data-cmid"),pagenum:t(this).attr("data-pagenum"),sesskey:t(this).attr("data-sesskey")};i({float:"none",mBotton:"0"}),t(".icontent-page").children(".fulltextpage").prepend(t("<div />").addClass("loading").html('<img src="pix/loading.gif" alt="Loading" class="img-loading" />')).css("opacity","0.5"),s(a.pagenum),a="&"+t.param(a),t.ajax({type:"POST",dataType:"json",url:"ajax.php",data:a,success:function(a){"0"!==a.transitioneffect?(t(".icontent-page").hide(),t(".icontent-page").html(a.fullpageicontent),t(".icontent-page").show(a.transitioneffect,1e3)):t(".icontent-page").html(a.fullpageicontent),o(),function(a){var e=t(".icontent-buttonbar .btn-previous-page"),n=t(".icontent-buttonbar .btn-next-page");a.previous?(e.removeAttr("disabled"),e.attr("data-pagenum",a.previous)):e.prop("disabled",!0);a.next?(n.removeAttr("disabled"),n.attr("data-pagenum",a.next)):n.prop("disabled",!0)}(a),i({float:"left",mBotton:"21px"})}})}function o(){"yes"==e.cookie("highcontrast")&&t(".fulltextpage").addClass("highcontrast").css({"background-color":"#000000","background-image":"none"})}function i(a){t(".fulltextpage").css({float:a.float,"margin-bottom":a.mBotton})}function s(a){a=a;t(".load-page").removeClass("active"),t(".btn-icontent-page").removeAttr("disabled"),t(".page"+a).addClass("active"),t(".page"+a).prop("disabled",!0)}return{init:function(){o(),s(t(".fulltextpage").attr("data-pagenum")),t(".load-page").click(n)}}});