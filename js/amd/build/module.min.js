define(["jquery","jqueryui","mod_icontent/cookiehandler"],function(a,b,c){function d(){var b={action:"loadpage",id:a(this).attr("data-cmid"),pagenum:a(this).attr("data-pagenum"),sesskey:a(this).attr("data-sesskey")};a(".icontent-page").children(".fulltextpage").prepend(a("<div />").addClass("loading").html('<img src="pix/loading.gif" alt="Loading" class="img-loading" />')).css("opacity","0.5"),g(b.pagenum),b="&"+a.param(b),a.ajax({type:"POST",dataType:"json",url:"ajax.php",data:b,success:function(b){"0"!==b.transitioneffect?(a(".icontent-page").hide(),a(".icontent-page").html(b.fullpageicontent),a(".icontent-page").show(b.transitioneffect,1e3)):a(".icontent-page").html(b.fullpageicontent),e(),f(b)}})}function e(){"yes"==c.cookie("highcontrast")&&a(".fulltextpage").addClass("highcontrast").css({"background-color":"#000000","background-image":"none"})}function f(b){var c=a(".icontent-buttonbar .btn-previous-page"),d=a(".icontent-buttonbar .btn-next-page");b.previous?(c.removeAttr("disabled"),c.attr("data-pagenum",b.previous)):c.prop("disabled",!0),b.next?(d.removeAttr("disabled"),d.attr("data-pagenum",b.next)):d.prop("disabled",!0)}function g(b){var b=b;a(".load-page").removeClass("active"),a(".btn-icontent-page").removeAttr("disabled"),a(".page"+b).addClass("active"),a(".page"+b).prop("disabled",!0)}return{init:function(){e(),g(a(".fulltextpage").attr("data-pagenum")),a(".load-page").click(d)}}});